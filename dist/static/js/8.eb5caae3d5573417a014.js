webpackJsonp([8],{R2UN:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("Xxa5"),o=t.n(s),n=t("Aaao"),r=t("mOxS"),i=t("P9l9");function l(e){return function(){var a=e.apply(this,arguments);return new Promise(function(e,t){return function s(o,n){try{var r=a[o](n),i=r.value}catch(e){return void t(e)}if(!r.done)return Promise.resolve(i).then(function(e){s("next",e)},function(e){s("throw",e)});e(i)}("next")})}}var c={data:function(){return{loading:!1,baseUrl:"//elm.cangdu.org/img/",shopData:{name:"",address:"",phone:null,description:"",twoTitle:"",category:"",tedian:{switch1:!0,switch2:!0,switch3:!0,switch4:!0,switch5:!0,switch6:!0},moneyps:1,moneyqs:20,startTime:"",endTime:"",shopImgUrl:null,shopzz:"",shopServer:"",huodong:"满减优惠"},categoryData:[],options:[{value:"满减优惠",label:"满减优惠"},{value:"优惠大酬宾",label:"优惠大酬宾"},{value:"新用户立减",label:"新用户立减"},{value:"进店领券",label:"进店领券"}],activities:[{icon_name:"减",title:"活动满减",description:"满30减5，满60减8"}],rules:{name:[{required:!0,message:"请输入店铺名称",trigger:"blur"}],address:[{required:!0,message:"请选择地址",trigger:"blur"}],phone:[{required:!0,message:"请输入电话号码",trigger:"blur"}],category:[{required:!0,message:"请选择商铺分类",trigger:"blur"}],shopImgUrl:[{required:!0,message:"请上传店铺图片",trigger:"blur"}],moneyps:[{required:!0,message:"请输入配送费",trigger:"blur"}],moneyqs:[{required:!0,message:"请输入起送价",trigger:"blur"}]}}},components:{indexHeader:n.a,indexFooter:r.default},methods:{getShopCategory:function(){var e=this;return l(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(i.y)(31.22967,121.4762);case 2:a.sent.forEach(function(a){if(a.sub_categories.length){var t={value:a.name,label:a.name,children:[]};a.sub_categories.forEach(function(e,a){if(0===a)return!1;t.children.push({value:e.name,label:e.name})}),e.categoryData.push(t)}}),console.log(e.categoryData);case 5:case"end":return a.stop()}},a,e)}))()},shopImgSuccess:function(e,a){console.log(e,a),1===e.status?this.shopData.shopImgUrl=e.image_path:this.$message.error("上传失败")},shopzzSuccess:function(e,a){console.log(e,a),1===e.status?this.shopData.shopzz=e.image_path:this.$message.error("上传失败")},shopServerSuccess:function(e,a){console.log(e,a),1===e.status?this.shopData.shopServer=e.image_path:this.$message.error("上传失败")},shopImgBefore:function(e){var a="image/jpeg"===e.type||"image/png"===e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传图片格式只能是png或者jpg格式"),t||this.$message.error("上传图片大小不能超过2M"),a&&t},changeSelected:function(){var e=this;this.$prompt("请输入活动详情","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var t=a.value;if(null==t)return e.$message.error("输入不能为空!"),!1;var s={};switch(e.shopData.huodong){case"满减优惠":s={icon_name:"减",title:"满减优惠",description:t};break;case"优惠大酬宾":s={icon_name:"特",title:"优惠大酬宾",description:t};break;case"新用户立减":s={icon_name:"新",title:"新用户立减",description:t};break;case"进店领券":s={icon_name:"领",title:"进店领券",description:t}}e.activities.push(s),console.log(e.activities)}).catch(function(){e.$message.error("取消输入")})},del:function(e){this.activities.splice(e,1)},add:function(e){var a=this;this.$refs[e].validate(function(e){if(!e)return console.log("错误"),!1;a.addData()})},resetForm:function(){this.$refs.shopForm.resetFields()},addData:function(){var e=this;return l(o.a.mark(function a(){var t;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,Object(i.c)(e.shopData.name,e.shopData.address,e.shopData.phone,31.23037,121.473701,e.shopData.category,e.shopData.shopImgUrl,e.shopData.moneyps,e.shopData.moneyqs,e.shopData.description,e.shopData.towTitle,e.shopData.tedian.switch1,e.shopData.tedian.switch2,e.shopData.tedian.switch3,e.shopData.tedian.switch4,e.shopData.tedian.switch5,e.shopData.tedian.switch6,e.shopData.startTime,e.shopData.endTime,e.shopData.shopzz,e.shopData.shopServer,e.activities);case 3:t=a.sent,console.log(t),t.status?(e.$message.success("恭喜您，店铺添加成功"),e.resetForm(),e.loading=!1):(e.loading=!1,e.$message.error(t.message));case 6:case"end":return a.stop()}},a,e)}))()}},mounted:function(){this.getShopCategory()}},p={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"homeRight"},[t("index-header"),e._v(" "),t("el-main",[t("el-form",{ref:"shopForm",staticClass:"demo-ruleForm",attrs:{model:e.shopData,"label-width":"140px",rules:e.rules}},[t("el-form-item",{attrs:{label:"店铺名称",prop:"name"}},[t("el-input",{model:{value:e.shopData.name,callback:function(a){e.$set(e.shopData,"name",a)},expression:"shopData.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺地址",prop:"address"}},[t("el-input",{model:{value:e.shopData.address,callback:function(a){e.$set(e.shopData,"address",a)},expression:"shopData.address"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[t("el-input",{model:{value:e.shopData.phone,callback:function(a){e.$set(e.shopData,"phone",a)},expression:"shopData.phone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺简介"}},[t("el-input",{model:{value:e.shopData.description,callback:function(a){e.$set(e.shopData,"description",a)},expression:"shopData.description"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺标语"}},[t("el-input",{model:{value:e.shopData.twoTitle,callback:function(a){e.$set(e.shopData,"twoTitle",a)},expression:"shopData.twoTitle"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺分类",prop:"category"}},[t("el-cascader",{attrs:{options:e.categoryData,"change-on-select":""},model:{value:e.shopData.category,callback:function(a){e.$set(e.shopData,"category",a)},expression:"shopData.category"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺特点"}},[t("el-col",{attrs:{span:8}},[e._v("\n          品牌保证 "),t("el-switch",{model:{value:e.shopData.tedian.switch1,callback:function(a){e.$set(e.shopData.tedian,"switch1",a)},expression:"shopData.tedian.switch1"}})],1),e._v(" "),t("el-col",{attrs:{span:8}},[e._v("\n          蜂鸟专送 "),t("el-switch",{model:{value:e.shopData.tedian.switch2,callback:function(a){e.$set(e.shopData.tedian,"switch2",a)},expression:"shopData.tedian.switch2"}})],1),e._v(" "),t("el-col",{attrs:{span:8}},[e._v("\n          新开店铺 "),t("el-switch",{model:{value:e.shopData.tedian.switch3,callback:function(a){e.$set(e.shopData.tedian,"switch3",a)},expression:"shopData.tedian.switch3"}})],1),e._v(" "),t("el-col",{attrs:{span:8}},[e._v("\n          外卖保 "),t("el-switch",{model:{value:e.shopData.tedian.switch4,callback:function(a){e.$set(e.shopData.tedian,"switch4",a)},expression:"shopData.tedian.switch4"}})],1),e._v(" "),t("el-col",{attrs:{span:8}},[e._v("\n           准时达 "),t("el-switch",{model:{value:e.shopData.tedian.switch5,callback:function(a){e.$set(e.shopData.tedian,"switch5",a)},expression:"shopData.tedian.switch5"}})],1),e._v(" "),t("el-col",{attrs:{span:8}},[e._v("\n          开发票 "),t("el-switch",{model:{value:e.shopData.tedian.switch6,callback:function(a){e.$set(e.shopData.tedian,"switch6",a)},expression:"shopData.tedian.switch6"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"配送费",prop:"moneyps"}},[t("el-input-number",{attrs:{min:1},model:{value:e.shopData.moneyps,callback:function(a){e.$set(e.shopData,"moneyps",a)},expression:"shopData.moneyps"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"起送价",prop:"moneyqs"}},[t("el-input-number",{attrs:{min:20},model:{value:e.shopData.moneyqs,callback:function(a){e.$set(e.shopData,"moneyqs",a)},expression:"shopData.moneyqs"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"营业时间"}},[t("el-time-select",{attrs:{placeholder:"起始时间","pick-options":{start:"08:30",step:"00:15",end:"18:30"}},model:{value:e.shopData.startTime,callback:function(a){e.$set(e.shopData,"startTime",a)},expression:"shopData.startTime"}}),e._v(" "),t("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:"08:30",step:"00:15",end:"18:30",minTime:e.shopData.startTime}},model:{value:e.shopData.endTime,callback:function(a){e.$set(e.shopData,"endTime",a)},expression:"shopData.endTime"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"上传店铺头像",prop:"shopImgUrl"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//elm.cangdu.org/v1/addimg/shop","show-file-list":!0,"on-success":e.shopImgSuccess,"before-upload":e.shopImgBefore}},[e.shopData.shopImgUrl?t("img",{staticClass:"avatar",attrs:{src:e.baseUrl+e.shopData.shopImgUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"上传营业执照"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//elm.cangdu.org/v1/addimg/shop","show-file-list":!1,"on-success":e.shopzzSuccess,"before-upload":e.shopImgBefore}},[e.shopData.shopzz?t("img",{staticClass:"avatar",attrs:{src:e.baseUrl+e.shopData.shopzz}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"上传餐饮服务许可证"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//elm.cangdu.org/v1/addimg/shop","show-file-list":!1,"on-success":e.shopServerSuccess,"before-upload":e.shopImgBefore}},[e.shopData.shopServer?t("img",{staticClass:"avatar",attrs:{src:e.baseUrl+e.shopData.shopServer}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"优惠活动"}},[t("el-select",{attrs:{placeholder:"请选择优惠活动"},on:{change:e.changeSelected},model:{value:e.shopData.huodong,callback:function(a){e.$set(e.shopData,"huodong",a)},expression:"shopData.huodong"}},e._l(e.options,function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-table",{attrs:{data:e.activities,border:"",stripe:""}},[t("el-table-column",{attrs:{label:"活动标题",prop:"icon_name"}}),e._v(" "),t("el-table-column",{attrs:{label:"活动名称",prop:"title"}}),e._v(" "),t("el-table-column",{attrs:{label:"活动详情",prop:"description"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.del(a.$index)}}},[e._v("\n              删除\n            ")])]}}])})],1)],1),e._v(" "),t("p",{staticClass:"tc"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(a){return e.add("shopForm")}}},[e._v("\n        "+e._s(e.loading?"添加中":"立即添加")+"\n      ")])],1)],1),e._v(" "),t("index-footer")],1)},staticRenderFns:[]};var h=t("VU/8")(c,p,!1,function(e){t("hl17")},null,null);a.default=h.exports},hl17:function(e,a){}});